{"version":3,"sources":["webpack:///./src/views/publish/index.vue?3637","webpack:///./src/views/publish/components/UpdateCover.vue?6777","webpack:///src/views/publish/components/UpdateCover.vue","webpack:///./src/views/publish/components/UpdateCover.vue?af9b","webpack:///./src/views/publish/components/UpdateCover.vue","webpack:///src/views/publish/index.vue","webpack:///./src/views/publish/index.vue?b24f","webpack:///./src/views/publish/index.vue","webpack:///./src/api/article.js","webpack:///./src/api/image.js","webpack:///./src/components/materialList.vue?419c","webpack:///./src/views/publish/index.vue?c21a","webpack:///./src/views/publish/components/UpdateCover.vue?5373","webpack:///./src/components/materialList.vue?644a","webpack:///src/components/materialList.vue","webpack:///./src/components/materialList.vue?848d","webpack:///./src/components/materialList.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","slot","switcher","on","goBack","directives","name","rawName","value","expression","ref","form","rules","model","callback","$$v","$set","extensions","cover","_v","type","_l","item","index","key","images","$event","onupdateCover","_e","channel","id","loading","onSubmit","_s","staticRenderFns","showDialog","Url","dialogVisible","activeName","uploadFile","onFileChange","confrimUpdate","props","components","MaterialList","data","imageUrl","methods","$refs","file","click","src","blob","created","component","UpdateCover","title","content","channel_id","channels","$router","go","validate","url","loadChannel","$route","query","loadArticle","computed","beforeRouteUpdate","from","resetFields","next","getArticleInfo","params","request","method","getArticleChannel","removeArticle","publishArticle","draft","editArticle","getArticleById","updateCommentStatus","commentStatus","article_id","allow_comment","uploadImg","getImg","deleteImg","collectImage","collect","collectChange","radio","nativeOn","image","select","staticStyle","isloading","is_collected","collectImg","deletImg","isSelectTool","total_count","pNum","onPageChange","uploadHeaders","uploadSuccess","isAddFun","isShowTool","Authorization","token","isActive","loadImage","$message","message"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,UAAU,CAACE,YAAY,mBAAmB,CAACF,EAAG,MAAM,CAACE,YAAY,WAAWC,MAAM,CAAC,KAAO,UAAUC,KAAK,UAAU,CAACJ,EAAG,iBAAiB,CAACG,MAAM,CAAC,QAAUP,EAAIS,SAAW,MAAMC,GAAG,CAAC,KAAOV,EAAIW,WAAW,GAAGP,EAAG,UAAU,CAACQ,WAAW,CAAC,CAACC,KAAK,UAAUC,QAAQ,YAAYC,MAAOf,EAAW,QAAEgB,WAAW,YAAYC,IAAI,cAAcV,MAAM,CAAC,MAAQP,EAAIkB,KAAK,cAAc,OAAO,MAAQlB,EAAImB,QAAQ,CAACf,EAAG,eAAe,CAACG,MAAM,CAAC,MAAQ,KAAK,KAAO,UAAU,CAACH,EAAG,WAAW,CAACgB,MAAM,CAACL,MAAOf,EAAIkB,KAAU,MAAEG,SAAS,SAAUC,GAAMtB,EAAIuB,KAAKvB,EAAIkB,KAAM,QAASI,IAAMN,WAAW,iBAAiB,GAAGZ,EAAG,eAAe,CAACG,MAAM,CAAC,MAAQ,KAAK,KAAO,YAAY,CAACH,EAAG,YAAY,CAACG,MAAM,CAAC,OAAS,MAAM,WAAaP,EAAIwB,WAAW,YAAc,WAAWJ,MAAM,CAACL,MAAOf,EAAIkB,KAAY,QAAEG,SAAS,SAAUC,GAAMtB,EAAIuB,KAAKvB,EAAIkB,KAAM,UAAWI,IAAMN,WAAW,mBAAmB,GAAGZ,EAAG,eAAe,CAACG,MAAM,CAAC,MAAQ,KAAK,KAAO,eAAe,CAACH,EAAG,iBAAiB,CAACgB,MAAM,CAACL,MAAOf,EAAIkB,KAAKO,MAAU,KAAEJ,SAAS,SAAUC,GAAMtB,EAAIuB,KAAKvB,EAAIkB,KAAKO,MAAO,OAAQH,IAAMN,WAAW,oBAAoB,CAACZ,EAAG,WAAW,CAACG,MAAM,CAAC,MAAQ,IAAI,CAACP,EAAI0B,GAAG,QAAQtB,EAAG,WAAW,CAACG,MAAM,CAAC,MAAQ,IAAI,CAACP,EAAI0B,GAAG,QAAQtB,EAAG,WAAW,CAACG,MAAM,CAAC,MAAQ,IAAI,CAACP,EAAI0B,GAAG,QAAQtB,EAAG,WAAW,CAACG,MAAM,CAAC,OAAS,IAAI,CAACP,EAAI0B,GAAG,SAAS,GAAI1B,EAAIkB,KAAKO,MAAME,KAAO,EAAG,CAACvB,EAAG,MAAM,CAACE,YAAY,cAAcN,EAAI4B,GAAI5B,EAAIkB,KAAKO,MAAU,MAAE,SAASI,EAAKC,GAAO,OAAO1B,EAAG,eAAe,CAAC2B,IAAID,EAAMxB,YAAY,QAAQC,MAAM,CAAC,SAAWP,EAAIkB,KAAKO,MAAMO,OAAOF,IAAQpB,GAAG,CAAC,YAAc,SAASuB,GAAQ,OAAOjC,EAAIkC,cAAcJ,EAAOG,UAAc,IAAIjC,EAAImC,MAAM,GAAG/B,EAAG,eAAe,CAACG,MAAM,CAAC,MAAQ,KAAK,KAAO,eAAe,CAACH,EAAG,YAAY,CAACG,MAAM,CAAC,YAAc,OAAOa,MAAM,CAACL,MAAOf,EAAIkB,KAAe,WAAEG,SAAS,SAAUC,GAAMtB,EAAIuB,KAAKvB,EAAIkB,KAAM,aAAcI,IAAMN,WAAW,oBAAoBhB,EAAI4B,GAAI5B,EAAY,UAAE,SAASoC,EAAQN,GAAO,OAAO1B,EAAG,YAAY,CAAC2B,IAAID,EAAMvB,MAAM,CAAC,MAAQ6B,EAAQvB,KAAK,MAAQuB,EAAQC,SAAQ,IAAI,GAAGjC,EAAG,eAAe,CAACA,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,UAAU,QAAUP,EAAIsC,SAAS5B,GAAG,CAAC,MAAQ,SAASuB,GAAQ,OAAOjC,EAAIuC,UAAS,MAAU,CAACvC,EAAI0B,GAAG1B,EAAIwC,GAAGxC,EAAIS,aAAaL,EAAG,YAAY,CAACM,GAAG,CAAC,MAAQ,SAASuB,GAAQ,OAAOjC,EAAIuC,UAAS,MAAS,CAACvC,EAAI0B,GAAG,WAAW,IAAI,IAAI,IAClyEe,EAAkB,G,YCDlB,G,UAAS,WAAa,IAAIzC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,kBAAkBI,GAAG,CAAC,MAAQV,EAAI0C,aAAa,CAAE1C,EAAO,IAAEI,EAAG,MAAM,CAACE,YAAY,YAAYC,MAAM,CAAC,IAAMP,EAAI2C,IAAI,IAAM,MAAMvC,EAAG,IAAI,CAACE,YAAY,mBAAmBF,EAAG,YAAY,CAACG,MAAM,CAAC,MAAQ,OAAO,QAAUP,EAAI4C,cAAc,MAAQ,MAAM,iBAAiB,IAAIlC,GAAG,CAAC,iBAAiB,SAASuB,GAAQjC,EAAI4C,cAAcX,KAAU,CAAC7B,EAAG,UAAU,CAACG,MAAM,CAAC,KAAO,QAAQa,MAAM,CAACL,MAAOf,EAAc,WAAEqB,SAAS,SAAUC,GAAMtB,EAAI6C,WAAWvB,GAAKN,WAAW,eAAe,CAACZ,EAAG,cAAc,CAACG,MAAM,CAAC,MAAQ,MAAM,KAAO,UAAU,CAACH,EAAG,gBAAgB,CAACa,IAAI,YAAYV,MAAM,CAAC,UAAW,EAAM,YAAa,EAAM,cAAe,MAAS,GAAGH,EAAG,cAAc,CAACG,MAAM,CAAC,MAAQ,OAAO,KAAO,WAAW,CAACH,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,WAAWG,GAAG,CAAC,MAAQV,EAAI8C,aAAa,CAAC9C,EAAI0B,GAAG,UAAUtB,EAAG,QAAQ,CAACa,IAAI,OAAOV,MAAM,CAAC,KAAO,OAAO,GAAK,YAAY,OAAS,IAAIG,GAAG,CAAC,OAASV,EAAI+C,gBAAgB3C,EAAG,MAAM,CAACE,YAAY,cAAc,CAACF,EAAG,MAAM,CAACa,IAAI,gBAAgBV,MAAM,CAAC,IAAM,GAAG,IAAM,SAAS,IAAI,GAAGH,EAAG,OAAO,CAACE,YAAY,gBAAgBC,MAAM,CAAC,KAAO,UAAUC,KAAK,UAAU,CAACJ,EAAG,YAAY,CAACM,GAAG,CAAC,MAAQ,SAASuB,GAAQjC,EAAI4C,eAAgB,KAAS,CAAC5C,EAAI0B,GAAG,SAAStB,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,WAAWG,GAAG,CAAC,MAAQV,EAAIgD,gBAAgB,CAAChD,EAAI0B,GAAG,UAAU,IAAI,IAAI,KACz2C,EAAkB,G,kEC6CtB,GACEb,KAAM,cACNoC,MAAO,CAAC,YACRC,WAAY,CACVC,aAAJ,QAEEC,KANF,WAOI,MAAO,CACLR,eAAe,EACfC,WAAY,SACZF,IAAK1C,KAAKoD,WAGdC,QAAS,CACPZ,WADJ,WAEMzC,KAAK2C,eAAgB,GAEvBE,WAJJ,WAKM7C,KAAKsD,MAAMC,KAAKC,SAElBV,aAPJ,WAQM,IAAN,2BAEA,yBACM9C,KAAKsD,MAAM,iBAAiBG,IAAMC,GAEpC,cAbJ,WAaA,uKACA,wBADA,oBAEA,wBACA,EAHA,uBAIA,YACA,eACA,kBANA,iCAUA,eACA,oBAXA,SAYA,kBAZA,OAYA,EAZA,OAaA,mBACA,sBACA,uCAfA,2BAgBA,uBAhBA,oBAiBA,uBACA,gBAlBA,wBAmBA,YACA,eACA,kBArBA,2BAyBA,6BACA,8CACA,mBA3BA,gDA+BEC,QAzDF,cC9CmX,I,wBCQ/WC,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,MAIa,EAAAA,E,4CCsEf,GACEhD,KAAM,UACNoC,MAAO,GACPC,WAAY,CACV,YAAa,EAAjB,KACIY,YAAJ,GAGEV,KARF,WASI,MAAO,CACLlC,KAAM,CACJ6C,MAAO,GACPC,QAAS,GACTvC,MAAO,CACLO,OAAQ,GACRL,KAAM,GAERsC,WAAY,IAEd9C,MAAO,CACL4C,MAAO,CACf,CACU,UAAV,EACU,QAAV,UACU,QAAV,QAEA,CACU,IAAV,EACU,IAAV,GACU,QAAV,WACU,QAAV,SAGQ,aAAc,CACtB,CACU,UAAV,EACU,QAAV,UACU,QAAV,WAGQE,WAAY,CACpB,CACU,UAAV,EACU,QAAV,UACU,QAAV,WAGQD,QAAS,CACjB,CACU,UAAV,gBACA,cACc,EAAd,qBAEc,KAGJ,QAAV,QAEA,CACU,UAAV,EACU,QAAV,SACU,QAAV,UAIME,SAAU,GACV5B,SAAS,EACTd,WAAY,CAClB,WACA,WACA,WACA,YAAQ,MAAR,IACA,YAAQ,QAAR,IACM,IAAN,QAAQ,QAAR,EAAQ,SAAR,IACM,IAAN,OACA,WACA,WACA,WACA,WACA,YACQ,cADR,SACA,GAAU,OAAV,qJACA,eACA,oBAFA,SAGA,kBAHA,cAGA,EAHA,yBAKA,iBALA,mDAWE8B,QAAS,CAEP3C,OAFJ,WAGMV,KAAKkE,QAAQC,IAAI,IAGnB7B,SANJ,SAMA,cACMtC,KAAKqC,SAAU,EACfrC,KAAKsD,MAAM,eAAec,SAAhC,mKACA,EADA,uBAEA,aAFA,mBAGA,GAHA,UAKA,oBACA,QACA,EAPA,iCAQA,2BARA,OAQA,EARA,gDAUA,yBAVA,QAUA,EAVA,eAaA,gBACA,YACA,4CACA,yCAEA,qCACA,4BAEA,YACA,eACA,eAGA,aA1BA,oGA8BI,YAtCJ,WAsCA,8KACA,iBADA,OACA,EADA,OAEA,gCAFA,8CAKI,YA3CJ,WA2CA,uKACA,oBADA,SAEA,kBAFA,OAEA,EAFA,OAGA,mBAHA,8CAMInC,cAjDJ,SAiDA,KACMjC,KAAKiB,KAAKO,MAAMO,OAAOF,GAASwC,IAGpCV,QAhJF,WAiJI3D,KAAKsE,cACDtE,KAAKuE,OAAOC,MAAMpC,IACpBpC,KAAKyE,eAGTC,SAAU,CACRlE,SADJ,WAEM,OAAOR,KAAKuE,OAAOC,MAAMpC,GAAK,KAAO,OAGzCuC,kBA3JF,SA2JA,OACQC,EAAKJ,MAAMpC,IACbpC,KAAKsD,MAAM,eAAeuB,cAC1BC,KAEAA,MCzPwV,ICQ1V,G,UAAY,eACd,EACAhF,EACA0C,GACA,EACA,KACA,WACA,OAIa,e,2CCnBf,8PAEO,SAASuC,EAAeC,GAC7B,OAAOC,eAAQ,CACbZ,IAAK,oBACLa,OAAQ,MACRF,WAIG,SAASG,IACd,OAAOF,eAAQ,CACbZ,IAAK,oBACLa,OAAQ,QAIL,SAASE,EAAchD,GAC5B,OAAO6C,eAAQ,CACbZ,IAAK,qBAAF,OAAuBjC,GAC1B8C,OAAQ,WAIL,SAASG,EAAelC,GAAqB,IAAfmC,EAAe,wDAClD,OAAOL,eAAQ,CACbZ,IAAK,oBACLa,OAAQ,OACRF,OAAQ,CAAEM,MAAOA,GACjBnC,SAIG,SAASoC,EAAYnD,EAAIe,GAAqB,IAAfmC,EAAe,wDACnD,OAAOL,eAAQ,CACbZ,IAAK,qBAAF,OAAuBjC,GAC1B8C,OAAQ,MACRF,OAAQ,CAAEM,MAAOA,GACjBnC,SAIG,SAASqC,EAAepD,GAC7B,OAAO6C,eAAQ,CACbZ,IAAK,qBAAF,OAAuBjC,GAC1B8C,OAAQ,QAIL,SAASO,EAAoBrD,EAAIsD,GACtC,OAAOT,eAAQ,CACbZ,IAAK,2BACLa,OAAQ,MACRF,OAAQ,CACNW,WAAYvD,GAEde,KAAM,CACJyC,cAAeF,O,6DCzDrB,wJAGO,SAASG,EAAU1C,GACxB,OAAO8B,eAAQ,CACbZ,IAAK,uBACLa,OAAQ,OACR/B,SAKG,SAAS2C,IAAoB,IAAbd,EAAa,uDAAJ,GAC9B,OAAOC,eAAQ,CACbZ,IAAK,uBACLW,WAKG,SAASe,EAAU3D,GACxB,OAAO6C,eAAQ,CACbZ,IAAK,wBAAF,OAA0BjC,GAC7B8C,OAAQ,WAKL,SAASc,EAAa5D,EAAI6D,GAC/B,OAAOhB,eAAQ,CACbZ,IAAK,wBAAF,OAA0BjC,GAC7B8C,OAAQ,MACR/B,KAAM,CACJ8C,e,6DCjCN,W,kCCAA,W,oCCAA,W,kCCAA,IAAInG,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,iBAAiB,CAACM,GAAG,CAAC,OAASV,EAAImG,eAAe/E,MAAM,CAACL,MAAOf,EAAS,MAAEqB,SAAS,SAAUC,GAAMtB,EAAIoG,MAAM9E,GAAKN,WAAW,UAAU,CAACZ,EAAG,kBAAkB,CAACG,MAAM,CAAC,OAAQ,IAAQ,CAACP,EAAI0B,GAAG,QAAQtB,EAAG,kBAAkB,CAACG,MAAM,CAAC,OAAQ,IAAO,CAACP,EAAI0B,GAAG,SAAS,GAAI1B,EAAY,SAAEI,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,WAAW8F,SAAS,CAAC,MAAQ,SAASpE,GAAQjC,EAAI4C,eAAgB,KAAQ,CAAC5C,EAAI0B,GAAG,UAAU1B,EAAImC,MAAM,GAAG/B,EAAG,cAAcA,EAAG,SAAS,CAACG,MAAM,CAAC,OAAS,KAAKP,EAAI4B,GAAI5B,EAAU,QAAE,SAASsG,EAAMxE,GAAO,OAAO1B,EAAG,SAAS,CAAC2B,IAAIuE,EAAMjE,GAAG9B,MAAM,CAAC,GAAK,GAAG,GAAK,EAAE,GAAK,EAAE,GAAK,IAAI,CAACH,EAAG,MAAM,CAACE,YAAY,WAAWI,GAAG,CAAC,MAAQ,SAASuB,GAAQjC,EAAIuG,OAASzE,KAAS,CAAC1B,EAAG,WAAW,CAACoG,YAAY,CAAC,OAAS,SAASjG,MAAM,CAAC,IAAM+F,EAAMhC,IAAI,IAAM,WAAW,CAAClE,EAAG,MAAM,CAACE,YAAY,aAAaC,MAAM,CAAC,KAAO,SAASC,KAAK,SAAS,CAACJ,EAAG,IAAI,CAACE,YAAY,0BAA0BkG,YAAY,CAAC,YAAY,cAAexG,EAAc,WAAEI,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,YAAY,CAACG,MAAM,CAAC,QAAU+F,EAAMG,UAAU,KAAO,UAAU,KAAOH,EAAMI,aAAe,kBAAoB,mBAAmB,OAAS,GAAG,KAAO,QAAQhG,GAAG,CAAC,MAAQ,SAASuB,GAAQ,OAAOjC,EAAI2G,WAAWL,OAAWlG,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,SAAS,KAAO,iBAAiB,OAAS,GAAG,KAAO,QAAQG,GAAG,CAAC,MAAQ,SAASuB,GAAQ,OAAOjC,EAAI4G,SAASN,EAAMjE,SAAS,GAAGrC,EAAImC,KAAMnC,EAAI6G,cAAgB7G,EAAIuG,SAAWzE,EAAO1B,EAAG,MAAM,CAACE,YAAY,eAAeN,EAAImC,MAAM,QAAO,GAAG/B,EAAG,gBAAgB,CAACG,MAAM,CAAC,WAAa,GAAG,OAAS,oBAAoB,MAAQP,EAAI8G,YAAY,eAAe9G,EAAI+G,KAAK,YAAY,IAAIrG,GAAG,CAAC,iBAAiBV,EAAIgH,aAAa,qBAAqB,SAAS/E,GAAQjC,EAAI+G,KAAK9E,GAAQ,sBAAsB,SAASA,GAAQjC,EAAI+G,KAAK9E,MAAW7B,EAAG,YAAY,CAACG,MAAM,CAAC,MAAQ,OAAO,kBAAiB,EAAK,QAAUP,EAAI4C,cAAc,MAAQ,MAAM,QAAS,GAAMlC,GAAG,CAAC,iBAAiB,SAASuB,GAAQjC,EAAI4C,cAAcX,KAAU,CAAC7B,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,GAAG,OAAS,yDAAyD,SAAW,GAAG,KAAO,QAAQ,QAAUP,EAAIiH,cAAc,aAAajH,EAAIkH,gBAAgB,CAAC9G,EAAG,IAAI,CAACE,YAAY,mBAAmBF,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAACN,EAAI0B,GAAG,aAAatB,EAAG,KAAK,CAACJ,EAAI0B,GAAG,YAAYtB,EAAG,MAAM,CAACE,YAAY,iBAAiBC,MAAM,CAAC,KAAO,OAAOC,KAAK,OAAO,CAACR,EAAI0B,GAAG,kCAAkC,IAAI,IACp8Ee,EAAkB,G,8CC0FtB,GACE5B,KAAM,eACNoC,MAAO,CACLkE,SAAU,CAAd,4BACIC,WAAY,CAAhB,4BACIP,aAAc,CAAlB,6BAEEzD,KAPF,WAOA,MACA,iDADA,EACA,MACI,MAAO,CACLgD,OAAO,EACPpE,OAAQ,GACRY,eAAe,EACfqE,cAAe,CACbI,cAAe,UAAYC,GAE7BR,YAAa,EACbC,KAAM,EACNR,OAAQ,KACRgB,UAAU,IAGdjE,QAAS,CAEP,UAFJ,SAEA,0KACA,IACA,UAFA,SAIA,gBACA,YACA,kBANA,OAIA,EAJA,OAQA,sCACA,sBAIA,uBACA,kBAEA,WAhBA,8CAmBI4D,cArBJ,WAsBMjH,KAAK2C,eAAgB,EACrB3C,KAAKuH,UAAUvH,KAAK8G,MACpB9G,KAAKwH,SAAS,CACZ9F,KAAM,UACN+F,QAAS,UAIbV,aA9BJ,WA+BM/G,KAAKuH,aAGPrB,cAlCJ,WAmCMlG,KAAKuH,UAAU,IAGjB,SAtCJ,SAsCA,mLACA,WACA,qBACA,OACA,CACA,uBACA,sBACA,iBAEA,+BATA,UACA,EADA,OAUA,cAVA,gCAWA,kBAXA,OAWA,EAXA,OAYA,eACA,WACA,WACA,eACA,iBAGA,WACA,WACA,eACA,eAGA,cAzBA,8CA6BI,WAnEJ,SAmEA,wKACA,eACA,kBAFA,SAGA,uBAHA,OAIA,cACA,EACA,WACA,WACA,eACA,iBAGA,WACA,WACA,eACA,cAGA,eAlBA,+CAqBE5D,QA9GF,WA+GI3D,KAAKuH,cC1M6U,I,wBCQlV3D,EAAY,eACd,EACA9D,EACA0C,GACA,EACA,KACA,WACA,MAIa,OAAAoB,E","file":"js/chunk-48fe3f94.9e89903a.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-card',{staticClass:\"publish_content\"},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('el-page-header',{attrs:{\"content\":_vm.switcher + '文章'},on:{\"back\":_vm.goBack}})],1),_c('el-form',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],ref:\"articleForm\",attrs:{\"model\":_vm.form,\"label-width\":\"80px\",\"rules\":_vm.rules}},[_c('el-form-item',{attrs:{\"label\":\"标题\",\"prop\":\"title\"}},[_c('el-input',{model:{value:(_vm.form.title),callback:function ($$v) {_vm.$set(_vm.form, \"title\", $$v)},expression:\"form.title\"}})],1),_c('el-form-item',{attrs:{\"label\":\"内容\",\"prop\":\"content\"}},[_c('el-tiptap',{attrs:{\"height\":\"500\",\"extensions\":_vm.extensions,\"placeholder\":\"请输入文章内容\"},model:{value:(_vm.form.content),callback:function ($$v) {_vm.$set(_vm.form, \"content\", $$v)},expression:\"form.content\"}})],1),_c('el-form-item',{attrs:{\"label\":\"封面\",\"prop\":\"cover.type\"}},[_c('el-radio-group',{model:{value:(_vm.form.cover.type),callback:function ($$v) {_vm.$set(_vm.form.cover, \"type\", $$v)},expression:\"form.cover.type\"}},[_c('el-radio',{attrs:{\"label\":1}},[_vm._v(\"单图\")]),_c('el-radio',{attrs:{\"label\":3}},[_vm._v(\"三图\")]),_c('el-radio',{attrs:{\"label\":0}},[_vm._v(\"无图\")]),_c('el-radio',{attrs:{\"label\":-1}},[_vm._v(\"自动\")])],1),(_vm.form.cover.type > 0)?[_c('div',{staticClass:\"cover_wrap\"},_vm._l((_vm.form.cover.type),function(item,index){return _c('update-cover',{key:index,staticClass:\"cover\",attrs:{\"imageUrl\":_vm.form.cover.images[index]},on:{\"updateCover\":function($event){return _vm.onupdateCover(index, $event)}}})}),1)]:_vm._e()],2),_c('el-form-item',{attrs:{\"label\":\"频道\",\"prop\":\"channel_id\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择\"},model:{value:(_vm.form.channel_id),callback:function ($$v) {_vm.$set(_vm.form, \"channel_id\", $$v)},expression:\"form.channel_id\"}},_vm._l((_vm.channels),function(channel,index){return _c('el-option',{key:index,attrs:{\"label\":channel.name,\"value\":channel.id}})}),1)],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.loading},on:{\"click\":function($event){return _vm.onSubmit(false)}}},[_vm._v(_vm._s(_vm.switcher))]),_c('el-button',{on:{\"click\":function($event){return _vm.onSubmit(true)}}},[_vm._v(\"存入草稿\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"cover-container\",on:{\"click\":_vm.showDialog}},[(_vm.Url)?_c('img',{staticClass:\"cover-img\",attrs:{\"src\":_vm.Url,\"alt\":\"\"}}):_c('i',{staticClass:\"el-icon-plus\"})]),_c('el-dialog',{attrs:{\"title\":\"选择封面\",\"visible\":_vm.dialogVisible,\"width\":\"60%\",\"append-to-body\":\"\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-tabs',{attrs:{\"type\":\"card\"},model:{value:(_vm.activeName),callback:function ($$v) {_vm.activeName=$$v},expression:\"activeName\"}},[_c('el-tab-pane',{attrs:{\"label\":\"素材库\",\"name\":\"first\"}},[_c('material-list',{ref:\"materList\",attrs:{\"isAddFun\":false,\"isShowTool\":false,\"isSelectTool\":true}})],1),_c('el-tab-pane',{attrs:{\"label\":\"上传图片\",\"name\":\"second\"}},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.uploadFile}},[_vm._v(\"点击上传\")]),_c('input',{ref:\"file\",attrs:{\"type\":\"file\",\"id\":\"fileInput\",\"hidden\":\"\"},on:{\"change\":_vm.onFileChange}}),_c('div',{staticClass:\"image_wrap\"},[_c('img',{ref:\"preview-image\",attrs:{\"src\":\"\",\"alt\":\"\"}})])],1)],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.confrimUpdate}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div class=\"cover-container\" @click=\"showDialog\">\r\n      <img class=\"cover-img\" v-if=\"Url\" :src=\"Url\" alt=\"\" />\r\n      <i v-else class=\"el-icon-plus\"></i>\r\n    </div>\r\n    <el-dialog\r\n      title=\"选择封面\"\r\n      :visible.sync=\"dialogVisible\"\r\n      width=\"60%\"\r\n      append-to-body\r\n    >\r\n      <el-tabs v-model=\"activeName\" type=\"card\">\r\n        <el-tab-pane label=\"素材库\" name=\"first\">\r\n          <material-list\r\n            :isAddFun=\"false\"\r\n            :isShowTool=\"false\"\r\n            :isSelectTool=\"true\"\r\n            ref=\"materList\"\r\n          ></material-list>\r\n        </el-tab-pane>\r\n        <el-tab-pane label=\"上传图片\" name=\"second\">\r\n          <el-button type=\"primary\" @click=\"uploadFile\">点击上传</el-button>\r\n          <input\r\n            type=\"file\"\r\n            id=\"fileInput\"\r\n            hidden\r\n            ref=\"file\"\r\n            @change=\"onFileChange\"\r\n          />\r\n          <div class=\"image_wrap\">\r\n            <img src=\"\" alt=\"\" ref=\"preview-image\" />\r\n          </div>\r\n        </el-tab-pane>\r\n      </el-tabs>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"confrimUpdate\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport MaterialList from '@/components/materialList.vue'\r\nimport { uploadImg } from '@/api/image'\r\n\r\nexport default {\r\n  name: 'UpdateCover',\r\n  props: ['imageUrl'],\r\n  components: {\r\n    MaterialList\r\n  },\r\n  data() {\r\n    return {\r\n      dialogVisible: false,\r\n      activeName: 'second',\r\n      Url: this.imageUrl\r\n    }\r\n  },\r\n  methods: {\r\n    showDialog() {\r\n      this.dialogVisible = true\r\n    },\r\n    uploadFile() {\r\n      this.$refs.file.click()\r\n    },\r\n    onFileChange() {\r\n      const file = this.$refs.file.files[0]\r\n\r\n      const blob = URL.createObjectURL(file)\r\n      this.$refs['preview-image'].src = blob\r\n    },\r\n    async confrimUpdate() {\r\n      if (this.activeName === 'second') {\r\n        const file = this.$refs.file.files[0]\r\n        if (!file) {\r\n          this.$message({\r\n            type: 'warning',\r\n            message: '请选择文件'\r\n          })\r\n          return\r\n        }\r\n        const fd = new FormData()\r\n        fd.append('image', file)\r\n        const res = await uploadImg(fd)\r\n        this.dialogVisible = false\r\n        this.Url = res.data.data.url\r\n        this.$emit('updateCover', res.data.data.url)\r\n      } else if (this.activeName === 'first') {\r\n        const res = this.$refs['materList']\r\n        if (res.select === null) {\r\n          this.$message({\r\n            type: 'warning',\r\n            message: '请选择文件'\r\n          })\r\n          return\r\n        }\r\n        this.Url = res.images[res.select].url\r\n        this.$emit('updateCover', res.images[res.select].url)\r\n        this.dialogVisible = false\r\n      }\r\n    }\r\n  },\r\n  created() {}\r\n}\r\n</script>\r\n<style scoped lang=\"less\">\r\n.cover-container {\r\n  border: 1px dashed #d9d9d9;\r\n  width: 180px;\r\n  height: 180px;\r\n  cursor: pointer;\r\n  border-radius: 6px;\r\n  .cover-img {\r\n    width: 180px;\r\n    height: 180px;\r\n  }\r\n}\r\n.cover-container:hover {\r\n  border-color: #409eff;\r\n}\r\n.el-icon-plus {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 178px;\r\n  height: 178px;\r\n  line-height: 178px;\r\n  text-align: center;\r\n}\r\n.image_wrap {\r\n  margin: 20px;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpdateCover.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpdateCover.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UpdateCover.vue?vue&type=template&id=1f66bfd9&scoped=true&\"\nimport script from \"./UpdateCover.vue?vue&type=script&lang=js&\"\nexport * from \"./UpdateCover.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UpdateCover.vue?vue&type=style&index=0&id=1f66bfd9&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1f66bfd9\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <el-card class=\"publish_content\">\r\n    <div slot=\"header\" class=\"clearfix\">\r\n      <el-page-header @back=\"goBack\" :content=\"switcher + '文章'\">\r\n      </el-page-header>\r\n    </div>\r\n    <el-form\r\n      v-loading=\"loading\"\r\n      ref=\"articleForm\"\r\n      :model=\"form\"\r\n      label-width=\"80px\"\r\n      :rules=\"rules\"\r\n    >\r\n      <el-form-item label=\"标题\" prop=\"title\">\r\n        <el-input v-model=\"form.title\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"内容\" prop=\"content\">\r\n        <el-tiptap\r\n          height=\"500\"\r\n          v-model=\"form.content\"\r\n          :extensions=\"extensions\"\r\n          placeholder=\"请输入文章内容\"\r\n        ></el-tiptap>\r\n      </el-form-item>\r\n      <el-form-item label=\"封面\" prop=\"cover.type\">\r\n        <el-radio-group v-model=\"form.cover.type\">\r\n          <el-radio :label=\"1\">单图</el-radio>\r\n          <el-radio :label=\"3\">三图</el-radio>\r\n          <el-radio :label=\"0\">无图</el-radio>\r\n          <el-radio :label=\"-1\">自动</el-radio>\r\n        </el-radio-group>\r\n        <template v-if=\"form.cover.type > 0\">\r\n          <div class=\"cover_wrap\">\r\n            <update-cover\r\n              :imageUrl=\"form.cover.images[index]\"\r\n              class=\"cover\"\r\n              v-for=\"(item, index) in form.cover.type\"\r\n              :key=\"index\"\r\n              @updateCover=\"onupdateCover(index, $event)\"\r\n            ></update-cover>\r\n          </div>\r\n        </template>\r\n      </el-form-item>\r\n      <el-form-item label=\"频道\" prop=\"channel_id\">\r\n        <el-select v-model=\"form.channel_id\" placeholder=\"请选择\">\r\n          <el-option\r\n            v-for=\"(channel, index) in channels\"\r\n            :key=\"index\"\r\n            :label=\"channel.name\"\r\n            :value=\"channel.id\"\r\n          ></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"onSubmit(false)\" :loading=\"loading\">{{\r\n          switcher\r\n        }}</el-button>\r\n        <el-button @click=\"onSubmit(true)\">存入草稿</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </el-card>\r\n</template>\r\n<script>\r\nimport UpdateCover from './components/UpdateCover'\r\nimport 'element-tiptap/lib/index.css'\r\nimport {\r\n  getArticleChannel,\r\n  publishArticle,\r\n  getArticleById,\r\n  editArticle\r\n} from '@/api/article'\r\nimport { uploadImg } from '@/api/image'\r\nimport {\r\n  // necessary extensions\r\n  ElementTiptap,\r\n  Doc,\r\n  Text,\r\n  Paragraph,\r\n  Heading,\r\n  Bold,\r\n  Underline,\r\n  Italic,\r\n  Strike,\r\n  ListItem,\r\n  BulletList,\r\n  OrderedList,\r\n  Image\r\n} from 'element-tiptap'\r\n\r\nexport default {\r\n  name: 'publish',\r\n  props: [],\r\n  components: {\r\n    'el-tiptap': ElementTiptap,\r\n    UpdateCover\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      form: {\r\n        title: '',\r\n        content: '',\r\n        cover: {\r\n          images: [],\r\n          type: 0\r\n        },\r\n        channel_id: ''\r\n      },\r\n      rules: {\r\n        title: [\r\n          {\r\n            required: true,\r\n            message: '请输入标题名称',\r\n            trigger: 'blur'\r\n          },\r\n          {\r\n            min: 5,\r\n            max: 30,\r\n            message: '至少大于5个字符',\r\n            trigger: 'blur'\r\n          }\r\n        ],\r\n        'cover.type': [\r\n          {\r\n            required: true,\r\n            message: '请选择封面类型',\r\n            trigger: 'change'\r\n          }\r\n        ],\r\n        channel_id: [\r\n          {\r\n            required: true,\r\n            message: '请选择频道类型',\r\n            trigger: 'change'\r\n          }\r\n        ],\r\n        content: [\r\n          {\r\n            validator: (rule, value, callback) => {\r\n              if (value === '<p></p>') {\r\n                callback(new Error('内容不能为空'))\r\n              } else {\r\n                callback()\r\n              }\r\n            },\r\n            trigger: 'blur'\r\n          },\r\n          {\r\n            required: true,\r\n            message: '内容不能为空',\r\n            trigger: 'blur'\r\n          }\r\n        ]\r\n      },\r\n      channels: [],\r\n      loading: false,\r\n      extensions: [\r\n        new Doc(),\r\n        new Text(),\r\n        new Paragraph(),\r\n        new Heading({ level: 5 }),\r\n        new Bold({ bubble: true }), // render command-button in bubble menu.\r\n        new Underline({ bubble: true, menubar: false }), // render command-button in bubble menu but not in menubar.\r\n        new Italic(),\r\n        new Strike(),\r\n        new ListItem(),\r\n        new BulletList(),\r\n        new OrderedList(),\r\n        new Image({\r\n          async uploadRequest(file) {\r\n            const fd = new FormData()\r\n            fd.append('image', file)\r\n            const res = await uploadImg(fd)\r\n\r\n            return res.data.data.url\r\n          }\r\n        })\r\n      ]\r\n    }\r\n  },\r\n  methods: {\r\n    // 回退\r\n    goBack() {\r\n      this.$router.go(-1)\r\n    },\r\n    // 提交\r\n    onSubmit(draft) {\r\n      this.loading = true\r\n      this.$refs['articleForm'].validate(async valid => {\r\n        if (!valid) {\r\n          this.loading = false\r\n          return false\r\n        }\r\n        const id = this.$route.query.id\r\n        let res = null\r\n        if (id) {\r\n          res = await editArticle(id, this.form, draft)\r\n        } else {\r\n          res = await publishArticle(this.form, draft)\r\n        }\r\n\r\n        if (res.status === 201) {\r\n          this.$message({\r\n            message: `${draft ? '存入草稿草稿' : '发布或修改成功'} `,\r\n            type: `${draft ? 'info' : 'success'} `\r\n          })\r\n          this.$refs['articleForm'].resetFields()\r\n          this.$router.push('/article')\r\n        } else {\r\n          this.$message({\r\n            message: '操作失败',\r\n            type: 'error'\r\n          })\r\n        }\r\n        this.loading = false\r\n      })\r\n    },\r\n    // 加载频道\r\n    async loadChannel() {\r\n      const res = await getArticleChannel()\r\n      this.channels = res.data.data.channels\r\n    },\r\n    // 加载文章\r\n    async loadArticle() {\r\n      const id = this.$route.query.id\r\n      const res = await getArticleById(id)\r\n      this.form = res.data.data\r\n    },\r\n    // 接受图片url\r\n    onupdateCover(index, url) {\r\n      this.form.cover.images[index] = url\r\n    }\r\n  },\r\n  created() {\r\n    this.loadChannel()\r\n    if (this.$route.query.id) {\r\n      this.loadArticle()\r\n    }\r\n  },\r\n  computed: {\r\n    switcher() {\r\n      return this.$route.query.id ? '修改' : '发布'\r\n    }\r\n  },\r\n  beforeRouteUpdate(to, from, next) {\r\n    if (from.query.id) {\r\n      this.$refs['articleForm'].resetFields()\r\n      next()\r\n    } else {\r\n      next()\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped lang=\"less\">\r\n.cover_wrap {\r\n  display: flex;\r\n}\r\n.cover {\r\n  margin: 10px;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=69f9b932&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=69f9b932&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"69f9b932\",\n  null\n  \n)\n\nexport default component.exports","import request from '../util/request'\r\n// 获取文章\r\nexport function getArticleInfo(params) {\r\n  return request({\r\n    url: '/mp/v1_0/articles',\r\n    method: 'get',\r\n    params\r\n  })\r\n}\r\n// 获取文章频道\r\nexport function getArticleChannel() {\r\n  return request({\r\n    url: '/mp/v1_0/channels',\r\n    method: 'get'\r\n  })\r\n}\r\n// 删除文章\r\nexport function removeArticle(id) {\r\n  return request({\r\n    url: `/mp/v1_0/articles/${id}`,\r\n    method: 'DELETE'\r\n  })\r\n}\r\n// 发布文章\r\nexport function publishArticle(data, draft = false) {\r\n  return request({\r\n    url: '/mp/v1_0/articles',\r\n    method: 'post',\r\n    params: { draft: draft },\r\n    data\r\n  })\r\n}\r\n// 修改文章\r\nexport function editArticle(id, data, draft = false) {\r\n  return request({\r\n    url: `/mp/v1_0/articles/${id}`,\r\n    method: 'put',\r\n    params: { draft: draft },\r\n    data\r\n  })\r\n}\r\n// 获取指定文章\r\nexport function getArticleById(id) {\r\n  return request({\r\n    url: `/mp/v1_0/articles/${id}`,\r\n    method: 'get'\r\n  })\r\n}\r\n// 修改文章评论状态\r\nexport function updateCommentStatus(id, commentStatus) {\r\n  return request({\r\n    url: '/mp/v1_0/comments/status',\r\n    method: 'put',\r\n    params: {\r\n      article_id: id\r\n    },\r\n    data: {\r\n      allow_comment: commentStatus\r\n    }\r\n  })\r\n}\r\n","import request from '../util/request'\r\n\r\n// 上传图片\r\nexport function uploadImg(data) {\r\n  return request({\r\n    url: '/mp/v1_0/user/images',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n\r\n// 获取图片素材\r\nexport function getImg(params = {}) {\r\n  return request({\r\n    url: '/mp/v1_0/user/images',\r\n    params\r\n  })\r\n}\r\n\r\n// 删除图片素材\r\nexport function deleteImg(id) {\r\n  return request({\r\n    url: `/mp/v1_0/user/images/${id}`,\r\n    method: 'delete'\r\n  })\r\n}\r\n\r\n// 收藏图片\r\nexport function collectImage(id, collect) {\r\n  return request({\r\n    url: `/mp/v1_0/user/images/${id}`,\r\n    method: 'PUT',\r\n    data: {\r\n      collect\r\n    }\r\n  })\r\n}\r\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./materialList.vue?vue&type=style&index=0&id=6aa67e52&scoped=true&lang=less&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=69f9b932&scoped=true&lang=less&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpdateCover.vue?vue&type=style&index=0&id=1f66bfd9&scoped=true&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"switch_radio\"},[_c('el-radio-group',{on:{\"change\":_vm.collectChange},model:{value:(_vm.radio),callback:function ($$v) {_vm.radio=$$v},expression:\"radio\"}},[_c('el-radio-button',{attrs:{\"label\":false}},[_vm._v(\"全部\")]),_c('el-radio-button',{attrs:{\"label\":true}},[_vm._v(\"收藏\")])],1),(_vm.isAddFun)?_c('el-button',{attrs:{\"type\":\"success\"},nativeOn:{\"click\":function($event){_vm.dialogVisible = true}}},[_vm._v(\"添加素材\")]):_vm._e()],1),_c('el-divider'),_c('el-row',{attrs:{\"gutter\":20}},_vm._l((_vm.images),function(image,index){return _c('el-col',{key:image.id,attrs:{\"xs\":12,\"sm\":8,\"md\":6,\"lg\":4}},[_c('div',{staticClass:\"img_wrap\",on:{\"click\":function($event){_vm.select = index}}},[_c('el-image',{staticStyle:{\"height\":\"180px\"},attrs:{\"src\":image.url,\"fit\":\"cover \"}},[_c('div',{staticClass:\"image-slot\",attrs:{\"slot\":\"error\"},slot:\"error\"},[_c('i',{staticClass:\"el-icon-picture-outline\",staticStyle:{\"font-size\":\"20px\"}})])]),(_vm.isShowTool)?_c('div',{staticClass:\"img_tool\"},[_c('el-button',{attrs:{\"loading\":image.isloading,\"type\":\"warning\",\"icon\":image.is_collected ? 'el-icon-star-on' : 'el-icon-star-off',\"circle\":\"\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.collectImg(image)}}}),_c('el-button',{attrs:{\"type\":\"danger\",\"icon\":\"el-icon-delete\",\"circle\":\"\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.deletImg(image.id)}}})],1):_vm._e(),(_vm.isSelectTool && _vm.select === index)?_c('div',{staticClass:\"select_fun\"}):_vm._e()],1)])}),1),_c('el-pagination',{attrs:{\"background\":\"\",\"layout\":\"prev, pager, next\",\"total\":_vm.total_count,\"current-page\":_vm.pNum,\"page-size\":20},on:{\"current-change\":_vm.onPageChange,\"update:currentPage\":function($event){_vm.pNum=$event},\"update:current-page\":function($event){_vm.pNum=$event}}}),_c('el-dialog',{attrs:{\"title\":\"上传素材\",\"append-to-body\":true,\"visible\":_vm.dialogVisible,\"width\":\"50%\",\"center\":true},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-upload',{attrs:{\"drag\":\"\",\"action\":\"http://api-toutiao-web.itheima.net/mp/v1_0/user/images\",\"multiple\":\"\",\"name\":\"image\",\"headers\":_vm.uploadHeaders,\"on-success\":_vm.uploadSuccess}},[_c('i',{staticClass:\"el-icon-upload\"}),_c('div',{staticClass:\"el-upload__text\"},[_vm._v(\"将文件拖到此处，或\"),_c('em',[_vm._v(\"点击上传\")])]),_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(\" 只能上传jpg/png文件，且不超过500kb \")])])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div class=\"switch_radio\">\r\n      <el-radio-group v-model=\"radio\" @change=\"collectChange\">\r\n        <el-radio-button :label=\"false\">全部</el-radio-button>\r\n        <el-radio-button :label=\"true\">收藏</el-radio-button>\r\n      </el-radio-group>\r\n\r\n      <el-button\r\n        v-if=\"isAddFun\"\r\n        type=\"success\"\r\n        @click.native=\"dialogVisible = true\"\r\n        >添加素材</el-button\r\n      >\r\n    </div>\r\n    <el-divider></el-divider>\r\n    <el-row :gutter=\"20\">\r\n      <el-col\r\n        v-for=\"(image, index) in images\"\r\n        :key=\"image.id\"\r\n        :xs=\"12\"\r\n        :sm=\"8\"\r\n        :md=\"6\"\r\n        :lg=\"4\"\r\n      >\r\n        <div class=\"img_wrap\" @click=\"select = index\">\r\n          <el-image style=\" height: 180px\" :src=\"image.url\" fit=\"cover \">\r\n            <div slot=\"error\" class=\"image-slot\">\r\n              <i class=\"el-icon-picture-outline\" style=\"font-size:20px\"></i>\r\n            </div>\r\n          </el-image>\r\n          <div class=\"img_tool\" v-if=\"isShowTool\">\r\n            <!-- 收藏 -->\r\n            <el-button\r\n              :loading=\"image.isloading\"\r\n              type=\"warning\"\r\n              @click=\"collectImg(image)\"\r\n              :icon=\"\r\n                image.is_collected ? 'el-icon-star-on' : 'el-icon-star-off'\r\n              \"\r\n              circle\r\n              size=\"mini\"\r\n            ></el-button>\r\n            <!-- 删除 -->\r\n            <el-button\r\n              type=\"danger\"\r\n              icon=\"el-icon-delete\"\r\n              @click=\"deletImg(image.id)\"\r\n              circle\r\n              size=\"mini\"\r\n            ></el-button>\r\n          </div>\r\n          <div class=\"select_fun\" v-if=\"isSelectTool && select === index\"></div>\r\n        </div>\r\n      </el-col>\r\n    </el-row>\r\n    <el-pagination\r\n      @current-change=\"onPageChange\"\r\n      background\r\n      layout=\"prev, pager, next\"\r\n      :total=\"total_count\"\r\n      :current-page.sync=\"pNum\"\r\n      :page-size=\"20\"\r\n    >\r\n    </el-pagination>\r\n    <el-dialog\r\n      title=\"上传素材\"\r\n      :append-to-body=\"true\"\r\n      :visible.sync=\"dialogVisible\"\r\n      width=\"50%\"\r\n      :center=\"true\"\r\n    >\r\n      <el-upload\r\n        drag\r\n        action=\"http://api-toutiao-web.itheima.net/mp/v1_0/user/images\"\r\n        multiple\r\n        name=\"image\"\r\n        :headers=\"uploadHeaders\"\r\n        :on-success=\"uploadSuccess\"\r\n      >\r\n        <i class=\"el-icon-upload\"></i>\r\n        <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\r\n        <div class=\"el-upload__tip\" slot=\"tip\">\r\n          只能上传jpg/png文件，且不超过500kb\r\n        </div>\r\n      </el-upload>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { getImg, deleteImg, collectImage } from '@/api/image'\r\nexport default {\r\n  name: 'MaterialList',\r\n  props: {\r\n    isAddFun: { Boolean, default: true },\r\n    isShowTool: { Boolean, default: true },\r\n    isSelectTool: { Boolean, default: false }\r\n  },\r\n  data() {\r\n    const { token } = JSON.parse(sessionStorage.getItem('user')) || ''\r\n    return {\r\n      radio: false,\r\n      images: [],\r\n      dialogVisible: false,\r\n      uploadHeaders: {\r\n        Authorization: 'Bearer ' + token\r\n      },\r\n      total_count: 0,\r\n      pNum: 1,\r\n      select: null,\r\n      isActive: true\r\n    }\r\n  },\r\n  methods: {\r\n    // 加载图片\r\n    async loadImage(page) {\r\n      if (page) {\r\n        this.pNum = page\r\n      }\r\n      const res = await getImg({\r\n        page: this.pNum,\r\n        collect: this.radio\r\n      })\r\n      this.total_count = res.data.data.total_count\r\n      const result = res.data.data.results\r\n      // 如果在实例创建之后添加新的属性到实例上，它不会触发视图更新\r\n      // 由于 Vue会在初始化实例时对属性执行 getter/setter 转化过程，\r\n      // 所以属性必须在 data 对象上存在才能让 Vue 转换它，这样才能让它是响应的\r\n      result.forEach(v => {\r\n        v.isloading = false\r\n      })\r\n      this.images = result\r\n    },\r\n    // 上传成功\r\n    uploadSuccess() {\r\n      this.dialogVisible = false\r\n      this.loadImage(this.pNum)\r\n      this.$message({\r\n        type: 'success',\r\n        message: '上传成功'\r\n      })\r\n    },\r\n    // 页数改变\r\n    onPageChange() {\r\n      this.loadImage()\r\n    },\r\n    // 切换收藏\r\n    collectChange() {\r\n      this.loadImage(1)\r\n    },\r\n    // 删除图片\r\n    async deletImg(id) {\r\n      const result = await this.$confirm(\r\n        '此操作将永久删除该图片, 是否继续?',\r\n        '删除提示',\r\n        {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }\r\n      ).catch(err => err)\r\n      if (result === 'confirm') {\r\n        const res = await deleteImg(id)\r\n        if (res.status === 204) {\r\n          this.$notify({\r\n            title: '成功',\r\n            message: '删除成功',\r\n            type: 'success'\r\n          })\r\n        } else {\r\n          this.$notify({\r\n            title: '错误',\r\n            message: '删除失败',\r\n            type: 'error'\r\n          })\r\n        }\r\n        this.loadImage()\r\n      }\r\n    },\r\n    // 收藏图片\r\n    async collectImg(image) {\r\n      image.isloading = true\r\n      const collect = !image.is_collected\r\n      await collectImage(image.id, collect)\r\n      this.loadImage()\r\n      if (collect) {\r\n        this.$notify({\r\n          title: '成功',\r\n          message: '收藏成功',\r\n          type: 'success'\r\n        })\r\n      } else {\r\n        this.$notify({\r\n          title: '提示',\r\n          message: '取消收藏',\r\n          type: 'info'\r\n        })\r\n      }\r\n      image.isloading = false\r\n    }\r\n  },\r\n  created() {\r\n    this.loadImage()\r\n  }\r\n}\r\n</script>\r\n<style scoped lang=\"less\">\r\n.switch_radio {\r\n  padding-bottom: 20px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n.el-col {\r\n  margin-top: 10px;\r\n}\r\n/deep/ .el-dialog__body {\r\n  overflow: hidden;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n.el-upload__tip {\r\n  text-align: center;\r\n}\r\n.el-row {\r\n  padding: 30px;\r\n}\r\n.img_wrap {\r\n  position: relative;\r\n  .img_tool {\r\n    display: flex;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n    position: absolute;\r\n    bottom: 3px;\r\n    width: 100%;\r\n    height: 20%;\r\n    background-color: rgba(0, 0, 0, 0.3);\r\n  }\r\n}\r\n.select_fun {\r\n  background-image: url('./1.png');\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  top: 0;\r\n  bottom: 0;\r\n  background-repeat: no-repeat;\r\n  background-size: cover;\r\n  opacity: 0.7;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./materialList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./materialList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./materialList.vue?vue&type=template&id=6aa67e52&scoped=true&\"\nimport script from \"./materialList.vue?vue&type=script&lang=js&\"\nexport * from \"./materialList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./materialList.vue?vue&type=style&index=0&id=6aa67e52&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6aa67e52\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}